(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[974],{172:(e,t,r)=>{"use strict";r.d(t,{A:()=>n});let n=(0,r(157).A)("LoaderCircle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]])},283:(e,t,r)=>{"use strict";r.d(t,{A:()=>u,AuthProvider:()=>l});var n=r(5155),i=r(2115),o=r(7039),a=r(3004),s=r(5317);let d=(0,i.createContext)(void 0),l=e=>{let{children:t}=e,[r,l]=(0,i.useState)(null),[u,c]=(0,i.useState)(!0),[p,f]=(0,i.useState)(!1);return(0,i.useEffect)(()=>{let e,t=(0,a.hg)(o.j2,t=>{if(e&&(e(),e=void 0),t&&o.db){let r=(0,s.H9)(o.db,"users",t.uid);c(!0),e=(0,s.aQ)(r,e=>{e.exists()?l(e.data()):(console.warn("Firestore user profile for UID ".concat(t.uid," not found. Using minimal profile from Auth.")),l({uid:t.uid,email:t.email,displayName:t.displayName,photoURL:t.photoURL,activeWeddingId:null})),c(!1),f(!1)},e=>{console.error("Error listening to user document:",e),l(null),c(!1),f(!1)})}else l(null),c(!1),f(!1)});return()=>{t(),e&&e()}},[]),(0,n.jsx)(d.Provider,{value:{user:r,loading:u,isAuthenticating:p,setIsAuthenticating:f},children:t})},u=()=>{let e=(0,i.useContext)(d);if(void 0===e)throw Error("useAuth must be used within an AuthProvider");return e}},3792:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>u});var n=r(5155),i=r(2115),o=r(5695),a=r(283),s=r(3873),d=r(172);function l(){let{user:e,loading:t}=(0,a.A)(),{weddingSession:r,loadingSession:l}=(0,s.i)(),u=(0,o.useRouter)();return(0,i.useEffect)(()=>{t||e&&l||(e?r?u.replace("/dashboard"):u.replace("/welcome"):u.replace("/login"))},[e,t,r,l,u]),(0,n.jsxs)("div",{className:"flex min-h-screen flex-col items-center justify-center p-4 bg-gradient-to-br from-primary/10 via-background to-accent/10",children:[(0,n.jsx)(d.A,{className:"h-16 w-16 animate-spin text-primary"}),(0,n.jsx)("p",{className:"mt-6 text-xl font-semibold text-primary-foreground",children:"TogetherPlan"}),(0,n.jsx)("p",{className:"text-muted-foreground",children:"Loading your wedding plans..."})]})}function u(){return(0,n.jsx)(s.W,{children:(0,n.jsx)(l,{})})}},3873:(e,t,r)=>{"use strict";r.d(t,{W:()=>l,i:()=>u});var n=r(5155),i=r(2115),o=r(283),a=r(5317),s=r(7039);let d=(0,i.createContext)(void 0),l=e=>{let{children:t}=e,{user:r,loading:l}=(0,o.A)(),[u,c]=(0,i.useState)(null),[p,f]=(0,i.useState)(!0);return(0,i.useEffect)(()=>{let e;if(l)return void f(!0);if((null==r?void 0:r.activeWeddingId)&&s.db){f(!0);let t=(0,a.H9)(s.db,"weddings",r.activeWeddingId);e=(0,a.aQ)(t,e=>{e.exists()?c({id:e.id,...e.data()}):(c(null),console.warn("Firestore_WeddingContext: Active wedding session ".concat(r.activeWeddingId," not found."))),f(!1)},e=>{console.error("Firestore_WeddingContext: Error listening to wedding session:",e),c(null),f(!1)})}else c(null),f(!1);return()=>{e&&e()}},[r,l]),(0,n.jsx)(d.Provider,{value:{weddingSession:u,setWeddingSession:c,loadingSession:p},children:t})},u=()=>{let e=(0,i.useContext)(d);if(void 0===e)throw Error("useWedding must be used within a WeddingProvider");return e}},5206:(e,t,r)=>{Promise.resolve().then(r.bind(r,3792))},5695:(e,t,r)=>{"use strict";var n=r(8999);r.o(n,"usePathname")&&r.d(t,{usePathname:function(){return n.usePathname}}),r.o(n,"useRouter")&&r.d(t,{useRouter:function(){return n.useRouter}})},7039:(e,t,r)=>{"use strict";r.d(t,{db:()=>f,j2:()=>p});var n=r(3915),i=r(3004),o=r(5317),a=r(858);let s={apiKey:"AIzaSyBjVh31ibQbBGpC5MRwCExHnl9FJMwjIqQ",authDomain:"togetherplan.firebaseapp.com",projectId:"togetherplan",storageBucket:"togetherplan.firebasestorage.app",messagingSenderId:"1000835742597",appId:"1:1000835742597:web:66b8a4d6a53bd68a6722ec",measurementId:r(1890).env.NEXT_PUBLIC_FIREBASE_MEASUREMENT_ID},d={apiKey:"API_KEY",authDomain:"AUTH_DOMAIN",projectId:"PROJECT_ID",storageBucket:"STORAGE_BUCKET",messagingSenderId:"MESSAGING_SENDER_ID",appId:"APP_ID",measurementId:"MEASUREMENT_ID"},l=!0,u=[];for(let e of["apiKey","authDomain","projectId"])if(!s[e]){let t=d[e]||String(e).toUpperCase(),r="NEXT_PUBLIC_FIREBASE_".concat(t);u.push(r)}u.length>0&&(console.error("Firebase config error: The following environment variables are not defined. Please set them in your .env file:\n"+u.map(e=>"- ".concat(e)).join("\n")+"\n\nAfter updating .env, you may need to restart your Next.js development server for the changes to take effect."),l=!1);let c=l&&!(0,n.Dk)().length?(0,n.Wp)(s):(0,n.Dk)().length?(0,n.Sx)():null,p=c?(0,i.xI)(c):null,f=c?(0,o.aU)(c):null;c&&(0,a.c7)(c)}},e=>{var t=t=>e(e.s=t);e.O(0,[992,644,391,441,684,358],()=>t(5206)),_N_E=e.O()}]);